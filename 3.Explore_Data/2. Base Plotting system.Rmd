---
title: "R Notebook"
output: html_notebook
---

### Base Plotting System

The Core Plotting Functions

graphics: plot, hist, boxplot

grDevices: X11, PDF, PostScript, PNG

The Lattice Plotting System

lattice: xyplot, bwplot, levelplot


### Base Graphics

* initialize a new plot
* annotate an existing plot

?par : help page so useful
```{r}
?par
```


#### Histogram
```{r}
library(datasets)

hist(airquality$Ozone)
```


#### Scatterplot

```{r}
with(airquality, plot(Wind, Ozone))
```

#### Boxplot

```{r}
airquality <- transform(airquality, Month = factor(Month))

boxplot(Ozone ~ Month, airquality, xlab = "Month", ylab = "Ozone (ppb)")
```

#### Important Base Graphics Paraneters

* pch: plotting symbol (default is circle)
* lty: line type (default is solid line)
* lwd: line width
* col: plotting color. colors() function gives you a vector of colors
* xlab: x-axis label
* ylab: y-axis label

* par(): is used to specify global graphics parameters that affect all plots
            in an R session.
    * las: orientation of the axis labels
    * bg: background color
    * mar: margin size
    * oma: outer margin size
    * mfrow: number of plots per row
    * mfcol: number of plots per collumn 

```{r}
par("lty")

par("col")

par("pch")
```


```{r}
par("bg")

par("mfrow")

par("mar")
```

#### Base plotting functions

plot: makes a scatterplot or another type of plot depending on class of the object
lines: add a line
points: add points
text: add text labels
title: add annotations, title, subtitle, 
mtext: add arbitrary text to the margins
axis: adding axis ticks/labels


#### base plot with annotations
```{r}
library(datasets)

with(airquality, plot(Wind, Ozone))
title(main = "Ozone and Wind in New York")
```



```{r}
### Here subset of data is colored blue

with(airquality, plot(Wind, Ozone, main = "Ozone and Wind in New York"))
with(subset(airquality, Month == 5), points(Wind, Ozone, col = "blue"))
```

type arguments

n: no plotting 

```{r}
### Here subset of data is coloerd blue and red

with(airquality, plot(Wind, Ozone, main = "Ozone and Wind in New York",
     type = "n"))
with(subset(airquality, Month == 5), points(Wind, Ozone, col = "blue"))
with(subset(airquality, Month != 5), points(Wind, Ozone, col = "red"))
legend("topright", pch = 1, col = c("blue", "red"),
       legend = c("May", "Other Months"))
```

### Plot with Regression line

```{r}
with(airquality, plot(Wind, Ozone,
                      main = "Ozone and Wind in New York",
                      pch = 20))
model <- lm(Ozone ~ Wind, airquality)
abline(model, lwd = 2)
```
#### Multiple Base Plots

```{r, fig.asp= 0.4, fig.width=5}
par(mfrow = c(1, 2))

with(airquality, {plot(Wind, Ozone,main = "Ozone and Wind")
    plot(Solar.R, Ozone, main = "Ozone and Solar Radiation")})
     
     
```


```{r, fig.asp= 0.4, fig.width=5}
par(mfrow = c(1, 3), mar = c(4, 4, 2, 1), oma = c(0, 0, 2, 0))

with(airquality, {
    plot(Wind, Ozone, main = "Ozone and Wind")
    plot(Solar.R, Ozone, main = "Ozone and Solar Radiation")
    plot(Temp, Ozone, main = "Ozone and Temperature")
    mtext("Ozone and Weather in New York", outer = TRUE)
    })
     
```

##### Summary

Plotting occurs in two stages:
    * Creation of a plot
    * Annotation of a plot (adding lines, points, text, legends)
    
    

##### Some Examples
```{r}
x = rnorm(100)
y = rnorm(100)
z = rnorm(100)
```


```{r}
hist(x)
```
pch: symbols
```{r}
plot(x, y,  pch = 20)

title("my scatterplot")
```
mar: margin size for each side c(bottom, left, top, right)
```{r}
plot(x, y,  pch = 20,
     mar = c(1, 1, 4, 4))

title("my scatterplot")
text(-2, -2, "Label")
legend("topleft", legend = "Data", pch = 20)

fit <- lm(y ~ x)
abline(fit, lwd = 3, col = "blue")
```

```{r}
plot(x, y, xlab = "Weight", ylab = "Height", 
     main = "Scatterplot", pch = 20)
legend("topright", legend = "Data", pch = 20)
abline(fit, lwd = 3, col = "red")
```

```{r}
z <- rpois(100, 2)
par(mfrow = c(2, 1))

plot(x, y, pch = 20)
plot(x, z, pch = 19)

par(mar = c(1, 2, 1, 1))
```

```{r}
x <- rnorm(100)
y <- x + rnorm(100)
g <- gl(2, 50, labels = c("Male", "Female"))
str(g)

plot(x, y, type = "n")
points(x[g == "Male"], y[g == "Male"], col = "blue", pch = 20)
points(x[g == "Female"], y[g == "Female"], col = "red")
```



