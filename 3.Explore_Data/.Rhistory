tapply(newyork0, newyork0$county.site, nrow)
sapply(split(newyork0, newyork0$county.site), nrow)
sapply(split(newyork0, newyork0$county.site), nrow)
sapply(split(newyork0, newyork0$county.site), nrow)
sapply(split(newyork0, newyork0$county.site), nrow)
sapply(split(newyork1, newyork1$county.site), nrow)
pm0sub <- subset(pm0, State.Code == 36 & County.Code == 63 & Site.ID == 2008)
pm1sub <- subset(pm1, State.Code == 36 & County.Code == 63 & Site.ID == 2008)
pm0sub <- subset(pm0, State.Code == 36 & County.Code == 63 & Site.ID == 2008)
pm1sub <- subset(pm1, State.Code == 36 & County.Code == 63 & Site.ID == 2008)
dim(pm0)
pm0sub <- subset(pm0, State.Code == 36 & County.Code == 63 & Site.ID == 2008)
pm1sub <- subset(pm1, State.Code == 36 & County.Code == 63 & Site.ID == 2008)
dim(pm0sub)
pm0sub <- subset(pm0, State.Code == 36 & County.Code == 63 & Site.ID == 2008)
pm1sub <- subset(pm1, State.Code == 36 & County.Code == 63 & Site.ID == 2008)
dim(pm0sub)
dim(pm1sub)
x0sub <- pm0sub$Sample.Value
x1sub <- pm1sub$Sample.Value
x0sub <- pm0sub$Sample.Value
x1sub <- pm1sub$Sample.Value
dates0 <- pm0sub$Date
dates1 <- pm1sub$Date
x0sub <- pm0sub$Sample.Value
x1sub <- pm1sub$Sample.Value
dates0 <- as.Date(as.character(pm0sub$Date), format = "%Y%m%d")
dates1 <- as.Date(as.character(pm1sub$Date), format = "%Y%m%d")
x0sub <- pm0sub$Sample.Value
x1sub <- pm1sub$Sample.Value
dates0 <- as.Date(as.character(pm0sub$Date), format = "%Y%m%d")
dates1 <- as.Date(as.character(pm1sub$Date), format = "%Y%m%d")
str(dates0)
plot(dates0, x0sub)
plot(dates0, x0sub)
plot(dates1, x1sub)
par(mfrow = c(1, 2), mar = c(4, 4, 2, 1))
plot(dates0, x0sub, pch = 20)
plot(dates1, x1sub, pch = 20)
par(mfrow = c(1, 2), mar = c(4, 4, 2, 1))
plot(dates0, x0sub, pch = 20)
abline(h = median(x0sub, na.rm = T))
plot(dates1, x1sub, pch = 20)
abline(h = median(x1sub, na.rm = T))
library(ggplot2)
qplot(dates1[negative], bins = 12, breaks = by_month(dates1,2))
library(ggplot2)
qplot(dates1[negative], bins = 12, breaks = 1)
library(ggplot2)
qplot(dates1[negative], breaks = 1)
library(ggplot2)
qplot(dates1[negative], bins = 12)
library(ggplot2)
qplot(dates1[negative])
library(ggplot2)
qplot(dates1[negative])
library(ggplot2)
qplot(dates1[negative])
library(ggplot2)
qplot(dates1[negative])
hist(dates1[negative], breaks  =  "month")
rm(list = ls())
library(dplyr)
pm0 <- read.table("data/pm25_data/RD_501_88101_1999-0.txt", sep = "|",
header = F, comment.char = "#", na.strings = "")
dim(pm0)
colnames <- readLines("data/pm25_data/RD_501_88101_1999-0.txt", 1)
colnames <- strsplit(colnames, split = "|", fixed = T)
colnames[[1]]
names(pm0) <- colnames[[1]]
names(pm0)
names(pm0) = make.names(names(pm0))
names(pm0)
x0 <- pm0$Sample.Value
class(x0)
str(x0)
summary(x0)
mean(is.na(x0))
library(data.table)
pm1 <- fread("data/pm25_data/RD_501_88101_2012-0.txt", sep = "|",
header = F, na.strings = "")
dim(pm1)
system.time(pm1 <- fread("data/pm25_data/RD_501_88101_2012-0.txt", sep = "|",
header = F, na.strings = ""))
system.time(pm1 <- read.table("data/pm25_data/RD_501_88101_2012-0.txt", sep = "|",
header = F, na.strings = ""))
pm1 <- read.table("data/pm25_data/RD_501_88101_2012-0.txt", sep = "|",
header = F, na.strings = "", comment.char = "#")
dim(pm1)
1304287 * 28 * 2^3 / 2^10  # kilo byte
1304287 * 28 * 2^3 / 2^20  # mega byte
1304287 * 28 * 2^3 / 2^30  # giga byte
object.size(pm1)
names(pm1) <- make.names(colnames[[1]])
names(pm1)
x1 <- pm1$Sample.Value
str(x1)
summary(x1)
summary(x0)
mean(is.na(x1))
boxplot(x0, x1)
boxplot(log(x0), log(x1))
negative  <- x1 < 0
sum(negative, na.rm = T)
mean(negative, na.rm = T)
dates <- pm1$Date
str(dates)
library(lubridate)
dates1 <- ymd(pm1$Date)
str(dates1)
dates2 <- as.Date(as.character(dates), format = "%Y%m%d")
str(dates2)
hist(dates1, "month")
hist(dates1[negative], breaks  =  "month")
library(ggplot2)
qplot(dates1[negative])
site0 <- unique(subset(pm0, State.Code == 36, c(County.Code, Site.ID)))
site1 <- unique(subset(pm1, State.Code == 36, c(County.Code, Site.ID)))
head(site0)
site10 <- paste(site0[, 1], site0[, 2], sep = ".")
site11 <- paste(site1[, 1], site1[, 2], sep = ".")
head(site10)
both <- intersect(site10, site11)
both
pm0$county.site <- with(pm0, paste(County.Code, Site.ID, sep = "."))
pm1$county.site <- with(pm1, paste(County.Code, Site.ID, sep = "."))
newyork0 <- subset(pm0, State.Code==36 & county.site %in% both)
newyork1 <- subset(pm1, State.Code==36 & county.site %in% both)
unique(newyork0$county.site)
table(newyork0$county.site)
table(newyork1$county.site)
sapply(split(newyork0, newyork0$county.site), nrow)
sapply(split(newyork1, newyork1$county.site), nrow)
pm0sub <- subset(pm0, State.Code == 36 & County.Code == 63 & Site.ID == 2008)
pm1sub <- subset(pm1, State.Code == 36 & County.Code == 63 & Site.ID == 2008)
dim(pm0sub)
dim(pm1sub)
x0sub <- pm0sub$Sample.Value
x1sub <- pm1sub$Sample.Value
dates10 <- as.Date(as.character(pm0sub$Date), format = "%Y%m%d")
dates11 <- as.Date(as.character(pm1sub$Date), format = "%Y%m%d")
str(dates10)
plot(dates10, x0sub)
plot(dates11, x1sub)
par(mfrow = c(1, 2), mar = c(4, 4, 2, 1))
plot(dates0, x0sub, pch = 20)
par(mfrow = c(1, 2), mar = c(4, 4, 2, 1))
plot(dates10, x0sub, pch = 20)
abline(h = median(x0sub, na.rm = T))
plot(dates11, x1sub, pch = 20)
abline(h = median(x1sub, na.rm = T))
par(mfrow = c(1, 2), mar = c(4, 4, 2, 1))
plot(dates10, x0sub, pch = 20)
abline(h = median(x0sub, na.rm = T))
plot(dates11, x1sub, pch = 20)
abline(h = median(x1sub, na.rm = T))
range(x0sub, na.rm = T)
range(x0sub, x1sub, na.rm = T)
range(x0sub, x1sub, na.rm = T)
range <- range(x0sub, x1sub, na.rm = T)
range
par(mfrow = c(1, 2), mar = c(4, 4, 2, 1))
plot(dates10, x0sub, pch = 20, ylim = range)
abline(h = median(x0sub, na.rm = T))
plot(dates11, x1sub, pch = 20, ylim = range)
abline(h = median(x1sub, na.rm = T))
par(mfrow = c(1, 2), mar = c(4, 4, 2, 1))
plot(dates10, x0sub, pch = 20, ylim = range)
abline(h = median(x0sub, na.rm = T))
plot(dates11, x1sub, pch = 20, ylim = range)
abline(h = median(x1sub, na.rm = T))
with(pm0,
tapply(Sample.Value, State.Code, mean, na.rm = T))
mean0 <- with(pm0,
tapply(Sample.Value, State.Code, mean, na.rm = T))
mean0
summary(mean0)
mean1 <- with(pm1,
tapply(Sample.Value, State.Code, mean, na.rm = T))
mean1
d0 <- data.frame(state = names(mean1), mean = mean0)
d0 <- data.frame(state = names(mean0), mean = mean0)
d0
d0 <- data.frame(state = names(mean0), mean = mean0)
head(d0)
d1 <- data.frame(state = names(mean1), mean = mean1)
head(d1)
merge(d0, d1, by = "state")
merged <- merge(d0, d1, by = "state")
merged
par(mfrow = c(1, 2))
with(merged,
plot(rep(1999, 52), mean.x))
par(mfrow = c(1, 2))
with(merged,
plot(rep(1999, 52), mean.x, xlim = c(1998, 2013)))
par(mfrow = c(1, 2))
with(merged,
points(rep(1999, 52), mean.x, xlim = c(1998, 2013))
points((rep(2012, 52), mean.y)))
par(mfrow = c(1, 2))
with(merged, points(rep(1999, 52), mean.x, xlim = c(1998, 2013)))
par(mfrow = c(1, 2))
with(merged, plot(rep(1999, 52), mean.x, xlim = c(1998, 2013)))
with(merged, points(rep(2012, 52), mean.y))
par(mfrow = c(1, 2))
with(merged, plot(rep(1999, 52), mean.x, xlim = c(1998, 2013)))
with(merged, points(rep(2012, 52), mean.y))
par(mfrow = c(1, 2))
with(merged, plot(rep(1999, 52), mean.x, xlim = c(1998, 2013)))
with(merged, points(rep(2012, 52), mean.y))
par(mfrow = c(1, 2))
with(merged, plot(rep(1999, 52), mean.x, xlim = c(1998, 2013)))
with(merged, points(rep(2012, 52), mean.y))
par(mfrow = c(1, 2))
with(merged, plot(rep(1999, 52), mean.x, xlim = c(1998, 2013)))
with(merged, points(rep(2012, 52), mean.y))
par(mfrow = c(1, 2))
with(merged, plot(rep(1999, 52), mean.x, xlim = c(1998, 2013)))
with(merged, points(rep(2012, 52), mean.y))
par(mfrow = c(1, 2))
with(merged, plot(rep(1999, 52), mean.x, xlim = c(1998, 2013)))
with(merged, points(rep(2012, 52), mean.y))
par(mfrow = c(1, 2))
with(merged, plot(rep(1999, 52), mean.x, xlim = c(1998, 2013)))
with(merged, points(rep(2012, 52), mean.y))
segments(rep(1999, 52), merged[, 2], rep(2012, 52), merged[, 3])
segments(rep(1999, 52), merged[, 2], rep(2012, 52), merged[, 3])
with(merged, plot(rep(1999, 52), mean.x, xlim = c(1998, 2013)))
with(merged, points(rep(2012, 52), mean.y))
segments(rep(1999, 52), merged[, 2], rep(2012, 52), merged[, 3])
with(merged, plot(rep(1999, 52), mean.x, xlim = c(1998, 2013)),
ylim=c(0, 20))
with(merged, points(rep(2012, 52), mean.y))
segments(rep(1999, 52), merged[, 2], rep(2012, 52), merged[, 3])
with(merged, plot(rep(1999, 52), mean.x, xlim = c(1998, 2013)),
ylim=c(0, 20))
with(merged, points(rep(2012, 52), mean.y) ,
ylim=c(0, 20))
segments(rep(1999, 52), merged[, 2], rep(2012, 52), merged[, 3])
library(swirl)
swirl()
dim(pm0)
head(pm0)
cnames
strsplit(cnames, sep = "|", fixed = TRUE)
strsplit(cnames, "|", fixed = TRUE)
strsplit(cnames, "|", fixed = TRUE)
cnames <- strsplit(cnames, "|", fixed = TRUE)
cnames
nsmes(pm0) <- make.names(cnames[[1]][wcol])
names(pm0) <- make.names(cnames[[1]][wcol])
head(pm0)
x0 <- pm0$Sample.Value
str(x0)
mean(is.na(x0))
names(pm1) <- make.names(cnames[[1]][wcol])
dim(pm1)
x1x <- pm1$Sample.Value
x1 <- pm1$Sample.Value
mean(is.na(x1))
summary(x0)
summary(x1)
boxplot(x0, x1)
boxplot(log10(x0), log10(x1))
negative <- x1 < 0
sum(negative, na.rm = T)
sum(negative, na.rm = TRUE)
mean(negative, na.rm = TRUE)
dates <- pm1$Date
str(dates)
dates <- as.Date(as.character(dates), format = "%Y%m%d")
head(dates)
hist(dates[negative], "month")
str(site0)
both <- intersect(site0, site1)
both
head(pm0)
cnt0 <- subset(pm0, State.Code == 36 & county.site %in% both)
cnt1 <- subset(pm1, State.Code == 36 & county.site %in% both)
sapply(split(cnt0, cnt0$county.site), nrow)
sapply(split(cnt1, cnt1$county.site), nrow)
pm0sub <- subset(pm0, County.Cod == 63 & Site.ID == 2008)
pm0sub <- subset(cnt0, County.Cod == 63 & Site.ID == 2008)
pm0sub <- subset(cnt0, county.site == 63.2008)
pm0sub <- subset(cnt0, County.Code==63 & Site.ID==2008)
pm1sub <- subset(cnt1, County.Code==63 & Site.ID==2008)
x0sub < pm0ub$Sample.Value
x0sub <- pm0ub$Sample.Value
x0sub <- pm0sub$Sample.Value
x1sub <- pm1sub$Sample.Value
dates) <- as.Date(as.character(pm0sub$Date), format = "%Y%m%d")
dates <- as.Date(as.character(pm0sub$Date), format = "%Y%m%d")
dates0 <- as.Date(as.character(pm0sub$Date),"%Y%m%d")
dates1 <- as.Date(as.character(pm1sub$Date),"%Y%m%d")
par(mfrow = c(1, 2))
par(mfrow = c(1, 2), mar = c(4, 4, 2, 1))
plot(dates0, x0sub, pch = 20)
abline(h= median(x0sub, na.rm = TRUE), lwd = 2)
plot(dates1, x1sub, pch = 20)
abline(h= median(x1sub, na.rm = TRUE), lwd = 2)
rng <- range(x0sub, x1sub, na.rm=TRUE)
rng
mn0 <- with(pm0, tapply(Sample.Value, State.Code, mean, na.rm = T)
)
mn0 <- with(pm0,tapply(Sample.Value,State.Code,mean,na.rm=TRUE))
str(mn0)
mn1 <- with(pm1,tapply(Sample.Value,State.Code,mean,na.rm=TRUE))
str(mn1)
summary(mn0)
summary(mn1)
d0 <- data.frame(state = names(mn0), mean = mn0)
d1 <- data.frame(state = names(mn1), mean = mn1)
mrg <- merge(d0, d1, by = "state")
dim(mrg)
head(mrg)
with(mrg, plot(rep(1,52), mrg[, 2], xlim = c(.5, 2.5)))
with(mrg, points(rep(2, 52), mrg[, 3]))
segments(rep(1, 52), merged[, 2], rep(2, 52), merged[, 3])
segments(rep(1, 52), mrg[, 2], rep(2, 52), mrg[, 3])
mrg[mrg$mean.x < mrg$mean.y, ]
x = c(140, 138, 150, 148, 135)
y = c(132, 135, 151, 146, 130)
meanx = mean(x)
meany = mean(y)
x1 = c(140, 138, 150, 148, 135)
x2 = c(132, 135, 151, 146, 130)
dif = mean(x2) - mean(x1)
tstat = (dif-0)/sd(dif)/sqrt(5)
pt(tstat, df = 8)
x1 = c(140, 138, 150, 148, 135)
x2 = c(132, 135, 151, 146, 130)
dif = mean(x2) - mean(x1)
tstat = (dif-0)/sd(dif)/sqrt(5)
pt(tstat, df = 8)
t.test(x1, x2, paired = T)
x1 = c(140, 138, 150, 148, 135)
x2 = c(132, 135, 151, 146, 130)
dif = (x2) - (x1)
tstat = (mean(dif)-0)/sd(dif)/sqrt(5)
pt(tstat, df = 8)
t.test(x1, x2, paired = T)
x1 = c(140, 138, 150, 148, 135)
x2 = c(132, 135, 151, 146, 130)
dif = (x2) - (x1)
tstat = (mean(dif)-0)/sd(dif)/sqrt(5)
pt(tstat, df = 4)
t.test(x1, x2, paired = T)
x1 = c(140, 138, 150, 148, 135)
x2 = c(132, 135, 151, 146, 130)
dif = (x2) - (x1)
tstat = (mean(dif)-0)/sd(dif)/sqrt(5)
pt(tstat, df = 4, lower.tail = F)
t.test(x1, x2, paired = T)
x1 = c(140, 138, 150, 148, 135)
x2 = c(132, 135, 151, 146, 130)
dif = (x2) - (x1)
tstat = (mean(dif)-0)/sd(dif)/sqrt(5)
pt(tstat, df = 4, lower.tail = F)
t.test(x1, x2, paired = T)
x1 = c(140, 138, 150, 148, 135)
x2 = c(132, 135, 151, 146, 130)
dif = (x2) - (x1)
tstat = (mean(dif)-0)/(sd(dif)/sqrt(5))
pt(tstat, df = 4, lower.tail = F)
x1 = c(140, 138, 150, 148, 135)
x2 = c(132, 135, 151, 146, 130)
dif = (x2) - (x1)
meandif = mean(dif)
tstat = (mean(dif)-0)/(sd(dif)/sqrt(5))
pt(tstat, df = 4, lower.tail = F)
x1 = c(140, 138, 150, 148, 135)
x2 = c(132, 135, 151, 146, 130)
dif = (x2) - (x1)
meandif = mean(dif)
tstat = (mean(dif)-0)/(sd(dif)/sqrt(5))
pt(tstat, df = 4, lower.tail = F)
x1 = c(140, 138, 150, 148, 135)
x2 = c(132, 135, 151, 146, 130)
dif = (x2) - (x1)
meandif = mean(dif)
tstat = (mean(dif)-0)/(sd(dif)/sqrt(5))
pt(tstat, df = 4, lower.tail = T)
x1 = c(140, 138, 150, 148, 135)
x2 = c(132, 135, 151, 146, 130)
dif = (x2) - (x1)
meandif = mean(dif)
tstat = (mean(dif)-0)/(sd(dif)/sqrt(5))
onesided_pvalue = pt(tstat, df = 4, lower.tail = T)
twosided_pvalue = 2*pt(tstat, df = 4, lower.tail = T)
x1 = c(140, 138, 150, 148, 135)
x2 = c(132, 135, 151, 146, 130)
dif = (x2) - (x1)
meandif = mean(dif)
tstat = (mean(dif)-0)/(sd(dif)/sqrt(5))
onesided_pvalue = pt(tstat, df = 4, lower.tail = T)
onesided_pvalue
twosided_pvalue = 2*pt(tstat, df = 4, lower.tail = T)
twosided_pvalue
x1 = c(140, 138, 150, 148, 135)
x2 = c(132, 135, 151, 146, 130)
dif = (x2) - (x1)
meandif = mean(dif)
sddif = sd(dif)
tstat = (mean(dif)-0)/(sd(dif)/sqrt(5))
onesided_pvalue = pt(tstat, df = 4, lower.tail = T)
onesided_pvalue
twosided_pvalue = 2*pt(tstat, df = 4, lower.tail = T)
twosided_pvalue
qt(.975, 8)
pbinom(q=2, size=4, prob = 0.75, lower.tail = F )
ppois(9, 17.87, lower.tail = T)
ppois(9, 18, lower.tail = T)
ppois(9, 18, lower.tail = F)
ppois(9, 17.87, lower.tail = T)
meanDifT = -3
meanDifC = 1
sdT = 1.5
sdC = 1.8
df = 18-2
pooledSd = sqrt((8*sdT^2 + 8*sdC^2)/16)
testStat = (meanDifT-meanDifC)/(pooledSd/sqrt(2/9))
pt(testStat, 16, lower.tail = F)
meanDifT = -3
meanDifC = 1
sdT = 1.5
sdC = 1.8
df = 18-2
pooledSd = sqrt((8*sdT^2 + 8*sdC^2)/16)
testStat = (meanDifT-meanDifC)/(pooledSd/sqrt(2/9))
pt(testStat, 16, lower.tail = T)
meanDifT = -3
meanDifC = 1
sdT = 1.5
sdC = 1.8
df = 18-2
pooledSd = sqrt((8*sdT^2 + 8*sdC^2)/16)
testStat = (meanDifT-meanDifC)/(pooledSd*sqrt(2/9))
pt(testStat, 16, lower.tail = T)
meanDifT = -3
meanDifC = 1
sdT = 1.5
sdC = 1.8
df = 18-2
pooledSd = sqrt((8*sdT^2 + 8*sdC^2)/16)
testStat = (meanDifT-meanDifC)/(pooledSd*sqrt(2/9))
2*pt(testStat, 16, lower.tail = T)
mu0 = 0
mua = 0.01
sigma = 0.04
n = 100
alpha = 0.05
z <- qnorm(1 - alpha)
pnorm(mu0 + z*sigma/sqrt(n), mean = mua, sd = sigma/sqrt(n), lower.tail = FALSE)
mu0 = 0
mua = 0.01
sigma = 0.04
n = 100
alpha = 0.05
power = 0.90
z <- qnorm(1 - alpha)
zquant = qnorm(p = 0.90, mean = mua, sd = sigma/sqrt(n), lower.tail = FALSE)
mu0 = 0
mua = 0.01
sigma = 0.04
n = 100
alpha = 0.05
power = 0.90
z <- qnorm(1 - alpha)
zquant = qnorm(p = 0.90, mean = mua, sd = sigma/sqrt(n), lower.tail = FALSE)
zquant
n = (z*sigma/ (zquant - mu0))^2
n
t.test(x1, x2, paired = T, alternative = "two.sided")
lambda = 1787 * 0.01
ppois(10, lambda = lambda)
lambda = 1787 * 0.01
ppois(10, lambda = lambda, lower.tail = T)
mu0 = 0
mua = 0.01
sigma = 0.04
n = 100
alpha = 0.05
power = 0.90
z <- qnorm(1 - alpha)
zquant = qnorm(p = 0.90, mean = mua, sd = sigma/sqrt(n), lower.tail = FALSE)
zquant
n = (z*sigma/ (zquant - mu0))
n^2
mu0 = 0
mua = 0.01
sigma = 0.04
n = 120
alpha = 0.05
z <- qnorm(1 - alpha)
pnorm(mu0 + z*sigma/sqrt(n), mean = mua, sd = sigma/sqrt(n), lower.tail = FALSE)
mu0 = 0
mua = 0.01
sigma = 0.04
n = 140
alpha = 0.05
z <- qnorm(1 - alpha)
pnorm(mu0 + z*sigma/sqrt(n), mean = mua, sd = sigma/sqrt(n), lower.tail = FALSE)
mu0 = 0
mua = 0.01
sigma = 0.04
n = 180
alpha = 0.05
z <- qnorm(1 - alpha)
pnorm(mu0 + z*sigma/sqrt(n), mean = mua, sd = sigma/sqrt(n), lower.tail = FALSE)
pbinom(q=3, size=4, prob = 0.75, lower.tail = F )
pbinom(q=2, size=4, prob = 0.5, lower.tail = F )
