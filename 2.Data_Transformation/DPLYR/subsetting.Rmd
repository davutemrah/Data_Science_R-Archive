---
title: "R Notebook"
output: html_notebook
---

# DPLYR / PLYR

```{r}
library(readxl)

edu <- read_xlsx("./data/1.education.xlsx")
names(edu)
```

# Subset examples
```{r}
# first column; 5th row
edu[5, 1]
```
```{r}
# first column by name of the column
edu[4:5, "region"]
```
```{r}
edu[c(1, 3, 5), c("region", "max")]
```
# Subsetting and Sorting

Logical operators

```{r}
edu[ (edu$max >= 2 & edu$max < 10) , ]
```
```{r}
edu[, which(c("region", "max")  %in% names(edu))]
```
# Dealing with missing values
```{r}
x[(x$var2 >8), ]
```
```{r}
# which command
x[which(x$var2 >8), ]
```

### DPLYR
```{r}
library(dplyr)

## subset columns
args(select)
```
ranges= : 
negetion= !
and or=  &  |
list =  c()

everything()
starts_with()
ends_with()
contains()   literal string
matches()   regular expression
where()

```{r}
# range
edu %>% select(shangai_ind:max) %>% slice(1:3)
```
```{r}
# negation (exlude max)
edu %>% select(!max) %>% slice(1:3)
```
```{r}
# negation (exlude max)
edu %>% select(-max) %>% slice(1:3)
```
select_all(data, function)

```{r}
edu %>% select_all(toupper) %>% names
```

select_at(data, vars, function)

```{r}
edu %>% 
    select_at(vars(!contains("enrol")), tolower) %>%
    names
```

select_if(data, logical, function)
```{r}
select_if(.tbl  = edu, 
          .predicate = is.numeric,
          .funs = toupper)
```
```{r}
sapply(edu, class)
```


## SORT
```{r}
sort(x$var1)    # default is ascending

sort(x$var1, decreasing = T) # decreasing

sort(x$var2, na.last = TRUE)
```
# Ordering DATA set
```{r}
x[order(x$var1, decreasing = T), ]

x[order(x$var1, x$var3), ]

```
## Ordering with plyr package
```{r}
library(plyr)

arrange(x, var1)

arrange(x, desc(var3))
```
## ADD rows or columns
```{r}
x$var4 <- rnorm(5, mean = 2)
x
```
```{r}
# column bind

y <- cbind(x, rnorm(5, mean = 5))

y
```





